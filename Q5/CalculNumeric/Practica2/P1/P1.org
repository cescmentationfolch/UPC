#+LATEX_HEADER: \usepackage[margin=3cm]{geometry}
#+LATEX_HEADER: \usepackage{xfrac}
#+OPTIONS: toc:nil

* P1
** Metode del trapezi i quadratura de Newton
*** Valors obtinguts:
 | Subintervals       |         4 |          8 |        16 |        32 |        64 |       128 |
 | Quadratura de Simpson | 0.9878242 |  0.0506787 | 0.1516852 | 0.3574180 | 0.3162449 | 0.3159174 |
 | Metode del Trapezi | 0.2114939 | -0.4753275 | 0.1954926 | 0.1715777 | 0.3111791 | 0.3149939 |
 | Subintervals       |       256 |        512 |      1024 |      2048 |      4096 |      8192 |
 | Quadratura de Simpson | 0.3159050 |  0.3159043 | 0.3159042 | 0.3159042 | 0.3159042 | 0.3159042 |
 | Metode del Trapezi | 0.3156883 |  0.3158510 | 0.3158910 | 0.3159009 | 0.3159034 | 0.3159040 |

 #+CAPTION: Convergencia de les quadratures
 #+NAME: fig:Convergencia P1
 [[./TrapezivsSimpson.jpg]]

 Observem que ambdos metodes convergeixen correctement, el metode del trapezi te una convergencia quadratica i la quadratura de Simpson una convergencia proporcional a h^5.

 Sabent que l'error que comentem a la quadratura de simpson decreix amb un ordre de 5, podem soposar que la longitud per la qual l'error es menor a 10^{-6} sera approximadament #Subintervals = 2/h = \(\frac{2}{^5\sqrt{10^6}} \). Necessitarem aproximadament 32 intervals.

 # Necessitem 512 intervals, f4 es gran
** Simpson Adaptat
*** Fita del Error
 Volem veure que la quadratura de Simpson adaptada ens produeix un error fitat (per \(2\epsilon\) en aquest cas). Considerem tots els intervals (x_i, y_i) tals que retornen el valor de la quadratura sense fer la crida recursiva. Sigui E_{i} l'error comes per l'interval i-essim, com tots aquests intervals son disjunts i la seva unio es (0,2) tenim que:
 \[ \sum_{i=0}^{r} E_{i} < \sum_{i=0}^{r} (y_i - x_i)*\epsilon = (b-a)*\epsilon = 2\epsilon \]
 Per tant l'error esta fitat per \( 2\epsilon.\)
*** Valors obtinguts
Cridant a la funcio amb una tolerancia de 10^{-3} obtenim 0.3159216 i un error absolut de 6.4188e-04. mentres que la funcio /integral/ a matlab ens retorna 0.3159042. En efecte, hem comes un error menor a 2\cdot10^{-3}.

Els intervals que utilitzem en aquest cas son (200 punts):

#+CAPTION: Simpson Adaptat amb tolerancia 10^{-3}
#+NAME: fig:Simpson Adaptat amb tolerancia 10^{-3}
[[./SimpsonAdaptat.jpg]]

Si volem una precisio de 10^{-6} obtenim com a resposta 0.3159041 i utilitzem 579 punts:

#+CAPTION: Simpson Adaptat amb tolerancia 10^{-6}
#+NAME: fig:Simpson Adaptat amb tolerancia 10^{-6}
[[./SimpsonAdaptat2.jpg]]

Donat que la figura oscil.la molt mes a la esquerre, si utilitzem la quadratura de simpson amb intervals uniformes utilitzem molts mes punts dels que necessitem, ja que a l'interval (0,1) no calen masses punts per poder aproximar el valor de l'integral. La quadratura de Simpson adaptada ens permet aproximar l'integral sense fer servir punts inutils. De fet quan volem una precisio de 10^{-6} nomes 68 punts es troben a l'interval (0,1)
